<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>FleeConnect Admin Panel v3.2.1</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: #0a0a0f;
            color: #e0e0e0;
            overflow-x: hidden;
            font-size: 13px;
        }

        .header {
            background: linear-gradient(135deg, #1a1a2e 0%, #16213e 100%);
            padding: 12px 25px;
            border-bottom: 2px solid #0f4c75;
            display: flex;
            justify-content: space-between;
            align-items: center;
            box-shadow: 0 2px 15px rgba(0,0,0,0.4);
            position: sticky;
            top: 0;
            z-index: 100;
        }

        .logo {
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .logo-icon {
            width: 28px;
            height: 28px;
            background: linear-gradient(45deg, #4CAF50, #45a049);
            border-radius: 6px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            color: white;
            font-size: 12px;
        }

        .header-title {
            font-size: 18px;
            font-weight: 600;
            color: #4CAF50;
        }

        .header-status {
            display: flex;
            align-items: center;
            gap: 20px;
        }

        .status-item {
            display: flex;
            align-items: center;
            gap: 6px;
            font-size: 12px;
        }

        .status-dot {
            width: 6px;
            height: 6px;
            border-radius: 50%;
            background: #4CAF50;
            animation: pulse 2s infinite;
        }

        @keyframes pulse {
            0% { opacity: 1; transform: scale(1); }
            50% { opacity: 0.7; transform: scale(1.2); }
            100% { opacity: 1; transform: scale(1); }
        }

        .main-container {
            display: grid;
            grid-template-columns: 220px 1fr;
            height: calc(100vh - 58px);
        }

        .sidebar {
            background: #151526;
            border-right: 2px solid #0f4c75;
            padding: 15px 0;
            overflow-y: auto;
        }

        .nav-item {
            padding: 10px 18px;
            cursor: pointer;
            transition: all 0.2s ease;
            border-left: 3px solid transparent;
            display: flex;
            align-items: center;
            gap: 10px;
            font-size: 12px;
        }

        .nav-item:hover {
            background: #1e1e3f;
            border-left-color: #4CAF50;
        }

        .nav-item.active {
            background: #1e1e3f;
            border-left-color: #4CAF50;
            color: #4CAF50;
        }

        .content {
            padding: 20px;
            overflow-y: auto;
            background: #0f0f1a;
        }

        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(180px, 1fr));
            gap: 15px;
            margin-bottom: 20px;
        }

        .stat-card {
            background: linear-gradient(135deg, #1a1a35 0%, #252545 100%);
            border: 1px solid #2a2a4a;
            border-radius: 8px;
            padding: 15px;
            text-align: center;
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
        }

        .stat-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 2px;
            background: linear-gradient(90deg, #4CAF50, #45a049);
        }

        .stat-card:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 20px rgba(76, 175, 80, 0.1);
        }

        .stat-value {
            font-size: 22px;
            font-weight: bold;
            color: #4CAF50;
            margin-bottom: 5px;
            font-family: 'Courier New', monospace;
        }

        .stat-label {
            font-size: 11px;
            color: #bbb;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .stat-change {
            font-size: 10px;
            margin-top: 3px;
            color: #4CAF50;
        }

        .panel {
            background: #1a1a30;
            border: 1px solid #2a2a4a;
            border-radius: 8px;
            margin-bottom: 20px;
            overflow: hidden;
            box-shadow: 0 2px 10px rgba(0,0,0,0.3);
        }

        .panel-header {
            background: linear-gradient(135deg, #252545 0%, #2a2a50 100%);
            padding: 12px 18px;
            border-bottom: 1px solid #2a2a4a;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .panel-title {
            font-size: 14px;
            font-weight: 600;
            color: #ffffff;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .panel-actions {
            display: flex;
            gap: 8px;
        }

        .btn {
            padding: 4px 10px;
            border: none;
            border-radius: 4px;
            font-size: 11px;
            cursor: pointer;
            transition: all 0.2s ease;
            font-family: inherit;
        }

        .btn-primary {
            background: #4CAF50;
            color: white;
        }

        .btn-secondary {
            background: #444;
            color: #ccc;
        }

        .btn-danger {
            background: #f44336;
            color: white;
        }

        .btn:hover {
            opacity: 0.9;
            transform: translateY(-1px);
        }

        .btn:disabled,
        .btn.disabled {
            opacity: 0.4;
            cursor: not-allowed;
            background: #555;
            color: #888;
            transform: none;
        }

        .btn:disabled:hover,
        .btn.disabled:hover {
            opacity: 0.4;
            transform: none;
        }

        .table {
            width: 100%;
            border-collapse: collapse;
            font-size: 11px;
        }

        .table th,
        .table td {
            padding: 8px 12px;
            text-align: left;
            border-bottom: 1px solid #2a2a4a;
        }

        .table th {
            background: #252545;
            font-weight: 600;
            color: #ffffff;
            font-size: 10px;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .table td {
            font-size: 11px;
            font-family: 'Courier New', monospace;
        }

        .table tr:hover {
            background: rgba(76, 175, 80, 0.05);
        }

        .status-badge {
            padding: 2px 6px;
            border-radius: 10px;
            font-size: 9px;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.3px;
        }

        .status-online { background: rgba(76, 175, 80, 0.2); color: #4CAF50; }
        .status-viewing { background: rgba(255, 193, 7, 0.2); color: #FFC107; }
        .status-submitting { background: rgba(255, 87, 34, 0.2); color: #FF5722; }
        .status-completed { background: rgba(33, 150, 243, 0.2); color: #2196F3; }
        .status-failed { background: rgba(244, 67, 54, 0.2); color: #F44336; }
        .status-verified { background: rgba(76, 175, 80, 0.2); color: #4CAF50; }
        .status-processing { background: rgba(255, 193, 7, 0.2); color: #FFC107; }
        .status-left { background: rgba(158, 158, 158, 0.2); color: #9E9E9E; }

        .chart-container {
            height: 250px;
            padding: 15px;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            color: #ccc;
            background: linear-gradient(135deg, #1a1a35 0%, #252545 100%);
        }

        .chart-bar {
            display: flex;
            align-items: center;
            gap: 10px;
            margin: 5px 0;
            width: 100%;
        }

        .chart-label {
            min-width: 60px;
            font-size: 10px;
        }

        .chart-progress {
            flex: 1;
            height: 20px;
            background: #2a2a4a;
            border-radius: 10px;
            overflow: hidden;
            position: relative;
        }

        .chart-fill {
            height: 100%;
            background: linear-gradient(90deg, #4CAF50, #45a049);
            transition: width 0.5s ease;
        }

        .chart-value {
            position: absolute;
            right: 8px;
            top: 50%;
            transform: translateY(-50%);
            font-size: 10px;
            color: white;
            font-weight: bold;
        }

        .log-entry {
            padding: 6px 15px;
            border-bottom: 1px solid #2a2a4a;
            font-family: 'Courier New', monospace;
            font-size: 10px;
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .log-timestamp {
            color: #4CAF50;
            font-weight: bold;
            min-width: 80px;
        }

        .log-level {
            min-width: 50px;
            font-weight: bold;
        }

        .log-level.info { color: #2196F3; }
        .log-level.warn { color: #FFC107; }
        .log-level.error { color: #F44336; }
        .log-level.success { color: #4CAF50; }

        .log-ip {
            color: #FF9800;
            min-width: 120px;
        }

        .log-action {
            color: #ccc;
            flex: 1;
        }

        .metric {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 8px 0;
            border-bottom: 1px solid #2a2a4a;
        }

        .metric:last-child {
            border-bottom: none;
        }

        .metric-label {
            font-size: 12px;
            color: #ccc;
        }

        .metric-value {
            font-size: 12px;
            font-weight: 600;
            color: #4CAF50;
            font-family: 'Courier New', monospace;
        }

        .progress-bar {
            width: 120px;
            height: 6px;
            background: #2a2a4a;
            border-radius: 3px;
            overflow: hidden;
            margin-left: 10px;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #4CAF50, #45a049);
            transition: width 0.3s ease;
        }

        .alert {
            background: rgba(244, 67, 54, 0.1);
            border: 1px solid #F44336;
            border-radius: 6px;
            padding: 12px;
            margin-bottom: 15px;
            display: flex;
            align-items: center;
            gap: 10px;
            font-size: 12px;
        }

        .alert-icon {
            color: #F44336;
            font-size: 16px;
        }

        .visitor-detail {
            background: #252545;
            border-radius: 4px;
            padding: 8px;
            margin: 4px 0;
            font-size: 10px;
            line-height: 1.4;
        }

        .ip-info {
            display: flex;
            flex-direction: column;
            gap: 2px;
        }

        .coordinates {
            color: #888;
            font-size: 9px;
        }

        .device-info {
            display: flex;
            flex-direction: column;
            gap: 2px;
        }

        .resolution {
            color: #888;
            font-size: 9px;
        }

        .two-column {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
        }

        .mini-stat {
            background: #252545;
            padding: 10px;
            border-radius: 6px;
            text-align: center;
            border: 1px solid #2a2a4a;
        }

        .mini-stat-value {
            font-size: 16px;
            font-weight: bold;
            color: #4CAF50;
            font-family: 'Courier New', monospace;
        }

        .mini-stat-label {
            font-size: 10px;
            color: #aaa;
            margin-top: 3px;
        }

        .scrollable {
            max-height: 400px;
            overflow-y: auto;
        }

        .scrollable::-webkit-scrollbar {
            width: 6px;
        }

        .scrollable::-webkit-scrollbar-track {
            background: #1a1a30;
        }

        .scrollable::-webkit-scrollbar-thumb {
            background: #4CAF50;
            border-radius: 3px;
        }

        /* Money Siphon Notifications */
        .money-notification {
            position: fixed;
            bottom: 20px;
            right: 20px;
            width: 350px;
            background: linear-gradient(135deg, #1a1a35 0%, #252545 100%);
            border: 1px solid #4CAF50;
            border-radius: 8px;
            padding: 16px;
            box-shadow: 0 8px 32px rgba(0,0,0,0.4);
            z-index: 4000;
            transform: translateX(400px);
            transition: all 0.3s ease;
            font-size: 12px;
            color: #e0e0e0;
        }

        .money-notification.show {
            transform: translateX(0);
        }

        .money-notification-header {
            display: flex;
            align-items: center;
            gap: 8px;
            margin-bottom: 8px;
            font-weight: 600;
            color: #4CAF50;
        }

        .money-notification-amount {
            font-size: 18px;
            font-weight: bold;
            color: #4CAF50;
            margin: 4px 0;
            font-family: 'Courier New', monospace;
        }

        .money-notification-details {
            font-size: 10px;
            color: #bbb;
            line-height: 1.3;
        }

        .money-notification-close {
            position: absolute;
            top: 8px;
            right: 12px;
            background: none;
            border: none;
            color: #666;
            font-size: 14px;
            cursor: pointer;
            padding: 0;
            width: 20px;
            height: 20px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .money-notification-close:hover {
            color: #ccc;
        }

        /* Credits */
        .credits {
            position: fixed;
            bottom: 10px;
            left: 20px;
            font-size: 11px;
            color: #666;
            z-index: 1000;
            opacity: 0.7;
        }

        .credits:hover {
            opacity: 1;
        }

        @media (max-width: 1024px) {
            .main-container {
                grid-template-columns: 1fr;
            }
            
            .sidebar {
                display: none;
            }
            
            .stats-grid {
                grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            }

            .two-column {
                grid-template-columns: 1fr;
            }
        }

        .footer {
            text-align: center;
            padding: 15px;
            color: #555;
            font-size: 10px;
            border-top: 1px solid #2a2a4a;
            background: #151526;
        }

        .blink {
            animation: blink 1s infinite;
        }

        @keyframes blink {
            0%, 50% { opacity: 1; }
            51%, 100% { opacity: 0.3; }
        }

        .realtime-indicator {
            display: inline-flex;
            align-items: center;
            gap: 4px;
            color: #4CAF50;
            font-size: 10px;
        }

        .country-flag {
            width: 16px;
            height: 12px;
            background: #444;
            border-radius: 2px;
            display: inline-flex;
            align-items: center;
            justify-content: center;
            font-size: 8px;
            margin-right: 4px;
        }
    </style>
</head>
<body>
    <div class="header">
        <div class="logo">
            <div class="logo-icon">FC</div>
            <div class="header-title">FleeConnect Admin Panel</div>
        </div>
        <div class="header-status">
            <div class="status-item">
                <div class="status-dot"></div>
                <span>System Online</span>
            </div>
            <div class="status-item">
                <span class="realtime-indicator">
                    <span class="blink">‚óè</span>
                    LIVE
                </span>
            </div>
            <div class="status-item">
                <span id="current-time"></span>
            </div>
            <div class="status-item">
                <span id="uptime">Uptime: 00:00:00</span>
            </div>
        </div>
    </div>

    <div class="main-container">
        <div class="sidebar">
            <div class="nav-item active" data-panel="dashboard">
                <span>üìä</span>
                <span>Dashboard</span>
            </div>
            <div class="nav-item" data-panel="visitors">
                <span>üëÅÔ∏è</span>
                <span>Live Visitors</span>
            </div>
            <div class="nav-item" data-panel="captures">
                <span>üéØ</span>
                <span>Captures</span>
            </div>

            <div class="nav-item" data-panel="fingerprints">
                <span>üîç</span>
                <span>Fingerprints</span>
            </div>
            <div class="nav-item" data-panel="logs">
                <span>üìã</span>
                <span>Activity Logs</span>
            </div>
            <div class="nav-item" data-panel="settings">
                <span>‚öôÔ∏è</span>
                <span>Configuration</span>
            </div>
        </div>

        <div class="content">
            <div id="dashboard-panel">
                <div class="stats-grid">
                    <div class="stat-card">
                        <div class="stat-value" id="total-visits">0</div>
                        <div class="stat-label">Total Visits</div>
                        <div class="stat-change" id="visits-change">+0</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-value" id="active-sessions">0</div>
                        <div class="stat-label">Active Sessions</div>
                        <div class="stat-change" id="sessions-change">+0</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-value" id="conversion-rate">0%</div>
                        <div class="stat-label">Conversion Rate</div>
                        <div class="stat-change" id="conversion-change">+0.0%</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-value" id="total-captures">0</div>
                        <div class="stat-label">Data Captures</div>
                        <div class="stat-change" id="captures-change">+0</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-value" id="bandwidth-used">0GB</div>
                        <div class="stat-label">Bandwidth Used</div>
                        <div class="stat-change" id="bandwidth-change">+0MB</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-value" id="success-rate">0%</div>
                        <div class="stat-label">Success Rate</div>
                        <div class="stat-change" id="success-change">+0.0%</div>
                    </div>
                </div>

                <div class="alert">
                    <div class="alert-icon">‚ö†Ô∏è</div>
                    <div>
                        <strong>Security Notice:</strong> Elevated traffic patterns detected from government IP ranges (203.0.***.*** - 216.255.***.***). Possible law enforcement surveillance detected. Consider rotating domain or implementing geographic IP blocking to avoid detection.
                    </div>
                </div>

                <div class="two-column">
                    <div class="panel">
                        <div class="panel-header">
                            <div class="panel-title">
                                <span>üåç</span>
                                Geographic Distribution
                            </div>
                        </div>
                        <div style="padding: 15px;">
                            <div class="metric">
                                <span class="metric-label">Downtown Los Santos</span>
                                <div style="display: flex; align-items: center;">
                                    <span class="metric-value" id="downtown-visits">0</span>
                                    <div class="progress-bar">
                                        <div class="progress-fill" id="downtown-progress" style="width: 0%;"></div>
                                    </div>
                                </div>
                            </div>
                            <div class="metric">
                                <span class="metric-label">Vinewood Hills</span>
                                <div style="display: flex; align-items: center;">
                                    <span class="metric-value" id="vinewood-visits">0</span>
                                    <div class="progress-bar">
                                        <div class="progress-fill" id="vinewood-progress" style="width: 0%;"></div>
                                    </div>
                                </div>
                            </div>
                            <div class="metric">
                                <span class="metric-label">Sandy Shores</span>
                                <div style="display: flex; align-items: center;">
                                    <span class="metric-value" id="sandy-visits">0</span>
                                    <div class="progress-bar">
                                        <div class="progress-fill" id="sandy-progress" style="width: 0%;"></div>
                                    </div>
                                </div>
                            </div>
                            <div class="metric">
                                <span class="metric-label">Paleto Bay</span>
                                <div style="display: flex; align-items: center;">
                                    <span class="metric-value" id="paleto-visits">0</span>
                                    <div class="progress-bar">
                                        <div class="progress-fill" id="paleto-progress" style="width: 0%;"></div>
                                    </div>
                                </div>
                            </div>
                            <div class="metric">
                                <span class="metric-label">Other Locations</span>
                                <div style="display: flex; align-items: center;">
                                    <span class="metric-value" id="other-visits">0</span>
                                    <div class="progress-bar">
                                        <div class="progress-fill" id="other-progress" style="width: 0%;"></div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="panel">
                        <div class="panel-header">
                            <div class="panel-title">
                                <span>‚ö°</span>
                                System Performance
                            </div>
                        </div>
                        <div style="padding: 15px;">
                            <div class="metric">
                                <span class="metric-label">CPU Usage</span>
                                <span class="metric-value" id="cpu-usage">0%</span>
                            </div>
                            <div class="metric">
                                <span class="metric-label">Memory Usage</span>
                                <span class="metric-value" id="memory-usage">0%</span>
                            </div>
                            <div class="metric">
                                <span class="metric-label">Network I/O</span>
                                <span class="metric-value" id="network-io">0 MB/s</span>
                            </div>
                            <div class="metric">
                                <span class="metric-label">Active Connections</span>
                                <span class="metric-value" id="active-connections">0</span>
                            </div>
                            <div class="metric">
                                <span class="metric-label">Response Time</span>
                                <span class="metric-value" id="response-time">0ms</span>
                            </div>
                            <div class="metric">
                                <span class="metric-label">Uptime</span>
                                <span class="metric-value" id="system-uptime">99.97%</span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <div id="visitors-panel" style="display: none;">
                <div class="panel">
                    <div class="panel-header">
                        <div class="panel-title">
                            <span>üëÅÔ∏è</span>
                            Live Visitor Monitoring
                            <span class="realtime-indicator">
                                <span class="blink">‚óè</span>
                                REAL-TIME
                            </span>
                        </div>
                        <div class="panel-actions">
                            <button class="btn btn-danger disabled" disabled>Block All</button>
                            <button class="btn btn-secondary disabled" disabled>Export CSV</button>
                            <button class="btn btn-primary disabled" disabled>Auto-Refresh</button>
                        </div>
                    </div>
                    <div class="scrollable">
                        <table class="table">
                            <thead>
                                <tr>
                                    <th>Visitor Info</th>
                                    <th>Location Details</th>
                                    <th>Device & Browser</th>
                                    <th>Session Info</th>
                                    <th>Status</th>
                                </tr>
                            </thead>
                            <tbody id="visitors-table">
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>

            <div id="captures-panel" style="display: none;">
                <div class="panel">
                    <div class="panel-header">
                        <div class="panel-title">
                            <span>üéØ</span>
                            Credential Captures
                        </div>
                        <div class="panel-actions">
                            <button class="btn btn-secondary disabled" disabled>Download All</button>
                            <button class="btn btn-danger disabled" disabled>Purge Logs</button>
                            <button class="btn btn-primary disabled" disabled>Export Report</button>
                        </div>
                    </div>
                    <div class="scrollable">
                        <table class="table">
                            <thead>
                                <tr>
                                    <th>Timestamp</th>
                                    <th>Email & Password</th>
                                    <th>Card Information</th>
                                    <th>Personal Details</th>
                                    <th>Location & IP</th>
                                    <th>Validation</th>
                                    <th>Status</th>
                                </tr>
                            </thead>
                            <tbody id="captures-table">
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>

            <div id="analytics-panel" style="display: none;">
                <div class="two-column">
                    <div class="panel">
                        <div class="panel-header">
                            <div class="panel-title">
                                <span>üìä</span>
                                Traffic Timeline
                            </div>
                        </div>
                        <div class="chart-container">
                            <div style="width: 100%;">
                                <div class="chart-bar">
                                    <div class="chart-label">Now</div>
                                    <div class="chart-progress">
                                        <div class="chart-fill" id="traffic-now" style="width: 0%;"></div>
                                        <div class="chart-value" id="traffic-now-value">0</div>
                                    </div>
                                </div>
                                <div class="chart-bar">
                                    <div class="chart-label">5m ago</div>
                                    <div class="chart-progress">
                                        <div class="chart-fill" id="traffic-5m" style="width: 0%;"></div>
                                        <div class="chart-value" id="traffic-5m-value">0</div>
                                    </div>
                                </div>
                                <div class="chart-bar">
                                    <div class="chart-label">10m ago</div>
                                    <div class="chart-progress">
                                        <div class="chart-fill" id="traffic-10m" style="width: 0%;"></div>
                                        <div class="chart-value" id="traffic-10m-value">0</div>
                                    </div>
                                </div>
                                <div class="chart-bar">
                                    <div class="chart-label">15m ago</div>
                                    <div class="chart-progress">
                                        <div class="chart-fill" id="traffic-15m" style="width: 0%;"></div>
                                        <div class="chart-value" id="traffic-15m-value">0</div>
                                    </div>
                                </div>
                                <div class="chart-bar">
                                    <div class="chart-label">20m ago</div>
                                    <div class="chart-progress">
                                        <div class="chart-fill" id="traffic-20m" style="width: 0%;"></div>
                                        <div class="chart-value" id="traffic-20m-value">0</div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="panel">
                        <div class="panel-header">
                            <div class="panel-title">
                                <span>üåê</span>
                                Browser Statistics
                            </div>
                        </div>
                        <div style="padding: 15px;">
                            <div class="metric">
                                <span class="metric-label">Chrome</span>
                                <div style="display: flex; align-items: center;">
                                    <span class="metric-value" id="chrome-percent">0%</span>
                                    <div class="progress-bar">
                                        <div class="progress-fill" id="chrome-progress" style="width: 0%;"></div>
                                    </div>
                                </div>
                            </div>
                            <div class="metric">
                                <span class="metric-label">Safari</span>
                                <div style="display: flex; align-items: center;">
                                    <span class="metric-value" id="safari-percent">0%</span>
                                    <div class="progress-bar">
                                        <div class="progress-fill" id="safari-progress" style="width: 0%;"></div>
                                    </div>
                                </div>
                            </div>
                            <div class="metric">
                                <span class="metric-label">Firefox</span>
                                <div style="display: flex; align-items: center;">
                                    <span class="metric-value" id="firefox-percent">0%</span>
                                    <div class="progress-bar">
                                        <div class="progress-fill" id="firefox-progress" style="width: 0%;"></div>
                                    </div>
                                </div>
                            </div>
                            <div class="metric">
                                <span class="metric-label">Edge</span>
                                <div style="display: flex; align-items: center;">
                                    <span class="metric-value" id="edge-percent">0%</span>
                                    <div class="progress-bar">
                                        <div class="progress-fill" id="edge-progress" style="width: 0%;"></div>
                                    </div>
                                </div>
                            </div>
                            <div class="metric">
                                <span class="metric-label">Opera</span>
                                <div style="display: flex; align-items: center;">
                                    <span class="metric-value" id="opera-percent">0%</span>
                                    <div class="progress-bar">
                                        <div class="progress-fill" id="opera-progress" style="width: 0%;"></div>
                                    </div>
                                </div>
                            </div>
                            <div class="metric">
                                <span class="metric-label">Other</span>
                                <div style="display: flex; align-items: center;">
                                    <span class="metric-value" id="other-browser-percent">0%</span>
                                    <div class="progress-bar">
                                        <div class="progress-fill" id="other-browser-progress" style="width: 0%;"></div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="panel">
                    <div class="panel-header">
                        <div class="panel-title">
                            <span>üì±</span>
                            Device & OS Distribution
                        </div>
                    </div>
                    <div style="padding: 15px;">
                        <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(150px, 1fr)); gap: 15px;">
                            <div class="mini-stat">
                                <div class="mini-stat-value" id="windows-users">0</div>
                                <div class="mini-stat-label">Windows Users</div>
                            </div>
                            <div class="mini-stat">
                                <div class="mini-stat-value" id="mobile-users">0</div>
                                <div class="mini-stat-label">Mobile Users</div>
                            </div>
                            <div class="mini-stat">
                                <div class="mini-stat-value" id="mac-users">0</div>
                                <div class="mini-stat-label">macOS Users</div>
                            </div>
                            <div class="mini-stat">
                                <div class="mini-stat-value" id="linux-users">0</div>
                                <div class="mini-stat-label">Linux Users</div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <div id="fingerprints-panel" style="display: none;">
                <div class="panel">
                    <div class="panel-header">
                        <div class="panel-title">
                            <span>üîç</span>
                            Browser Fingerprinting Data
                        </div>
                        <div class="panel-actions">
                            <button class="btn btn-secondary disabled" disabled>Analyze Patterns</button>
                            <button class="btn btn-primary disabled" disabled>Generate Report</button>
                        </div>
                    </div>
                    <div class="scrollable">
                        <table class="table">
                            <thead>
                                <tr>
                                    <th>Visitor Info</th>
                                    <th>Display Properties</th>
                                    <th>Browser Capabilities</th>
                                    <th>Network & Privacy</th>
                                    <th>Fingerprint Hashes</th>
                                    <th>Uniqueness</th>
                                </tr>
                            </thead>
                            <tbody id="fingerprints-table">
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>

            <div id="logs-panel" style="display: none;">
                <div class="panel">
                    <div class="panel-header">
                        <div class="panel-title">
                            <span>üìã</span>
                            System Activity Logs
                            <span class="realtime-indicator">
                                <span class="blink">‚óè</span>
                                LIVE FEED
                            </span>
                        </div>
                        <div class="panel-actions">
                            <button class="btn btn-secondary">Filter</button>
                            <button class="btn btn-secondary">Clear</button>
                            <button class="btn btn-primary">Download</button>
                        </div>
                    </div>
                    <div id="logs-container" class="scrollable">
                    </div>
                </div>
            </div>

            <div id="settings-panel" style="display: none;">
                <div class="two-column">
                    <div class="panel">
                        <div class="panel-header">
                            <div class="panel-title">
                                <span>‚öôÔ∏è</span>
                                Configuration Settings
                            </div>
                        </div>
                        <div style="padding: 15px;">
                            <div class="metric">
                                <span class="metric-label">Auto-redirect delay</span>
                                <span class="metric-value">3.2s</span>
                            </div>
                            <div class="metric">
                                <span class="metric-label">Target site URL</span>
                                <span class="metric-value">banking.gta.world</span>
                            </div>
                            <div class="metric">
                                <span class="metric-label">Log retention period</span>
                                <span class="metric-value">14 days</span>
                            </div>
                            <div class="metric">
                                <span class="metric-label">SSL Certificate</span>
                                <span class="metric-value">Valid (expires 89d)</span>
                            </div>
                            <div class="metric">
                                <span class="metric-label">Rate limiting</span>
                                <span class="metric-value">100 req/min</span>
                            </div>
                            <div class="metric">
                                <span class="metric-label">Data compression</span>
                                <span class="metric-value">gzip enabled</span>
                            </div>
                        </div>
                    </div>

                    <div class="panel">
                        <div class="panel-header">
                            <div class="panel-title">
                                <span>üîí</span>
                                Security Status
                            </div>
                        </div>
                        <div style="padding: 15px;">
                            <div class="metric">
                                <span class="metric-label">DDoS Protection</span>
                                <span class="metric-value">ACTIVE</span>
                            </div>
                            <div class="metric">
                                <span class="metric-label">WAF Status</span>
                                <span class="metric-value">ENABLED</span>
                            </div>
                            <div class="metric">
                                <span class="metric-label">Bot Detection</span>
                                <span class="metric-value">ADVANCED</span>
                            </div>
                            <div class="metric">
                                <span class="metric-label">Geo-blocking</span>
                                <span class="metric-value">CONFIGURED</span>
                            </div>
                            <div class="metric">
                                <span class="metric-label">Log encryption</span>
                                <span class="metric-value">DISABLED</span>
                            </div>
                            <div class="metric">
                                <span class="metric-label">Data retention</span>
                                <span class="metric-value">7 days</span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="footer">
                FleeConnect Administration Panel v3.2.1 | Build #4729 | Deployed 3d 12h ago | Server: edge-server-lax02.cloudflare.com:443
            </div>
        </div>
    </div>

    <!-- Credits -->
    <div class="credits">
        made with ‚ù§Ô∏è by @cinnamoroll
    </div>

    <script>
        // San Andreas locations with LA coordinates
        const locations = [
            { name: 'Downtown Los Santos', coords: '34.0522¬∞N 118.2437¬∞W', zip: '90012', isp: 'LS Fiber Network', weight: 8 },
            { name: 'Vinewood Hills', coords: '34.1341¬∞N 118.3215¬∞W', zip: '90210', isp: 'Vinewood Cable Co', weight: 6 },
            { name: 'Mission Row', coords: '34.0459¬∞N 118.2478¬∞W', zip: '90013', isp: 'LSPD Network', weight: 5 },
            { name: 'Vespucci Beach', coords: '34.0195¬∞N 118.4912¬∞W', zip: '90291', isp: 'Beach Connect ISP', weight: 4 },
            { name: 'Del Perro', coords: '34.0278¬∞N 118.4965¬∞W', zip: '90293', isp: 'Pacific Internet', weight: 3 },
            { name: 'Rockford Hills', coords: '34.0736¬∞N 118.4004¬∞W', zip: '90210', isp: 'Hills Premium Net', weight: 4 },
            { name: 'Burton', coords: '34.0736¬∞N 118.3449¬∞W', zip: '90212', isp: 'Burton Broadband', weight: 3 },
            { name: 'Hawick', coords: '34.0736¬∞N 118.3104¬∞W', zip: '90028', isp: 'Hawick Networks', weight: 3 },
            { name: 'Little Seoul', coords: '34.0736¬∞N 118.3019¬∞W', zip: '90020', isp: 'Seoul Telecom SA', weight: 2 },
            { name: 'Textile City', coords: '34.0459¬∞N 118.2653¬∞W', zip: '90014', isp: 'Industrial Net', weight: 3 },
            { name: 'Strawberry', coords: '34.0195¬∞N 118.2653¬∞W', zip: '90037', isp: 'Strawberry ISP', weight: 2 },
            { name: 'Davis', coords: '34.0195¬∞N 118.2828¬∞W', zip: '90011', isp: 'Davis Community Net', weight: 2 },
            { name: 'Sandy Shores', coords: '35.2827¬∞N 116.8190¬∞W', zip: '92277', isp: 'Desert Wireless', weight: 4 },
            { name: 'Paleto Bay', coords: '36.5270¬∞N 121.0193¬∞W', zip: '93428', isp: 'Bay Area Internet', weight: 3 },
            { name: 'Grapeseed', coords: '36.4827¬∞N 120.9193¬∞W', zip: '93654', isp: 'Rural Connect SA', weight: 1 },
            { name: 'Mount Chiliad', coords: '36.5970¬∞N 121.1193¬∞W', zip: '93420', isp: 'Mountain Link', weight: 1 },
            { name: 'Harmony', coords: '35.6827¬∞N 117.2190¬∞W', zip: '93516', isp: 'Harmony Telecom', weight: 1 },
            { name: 'Blaine County', coords: '36.2827¬∞N 118.8190¬∞W', zip: '93515', isp: 'Blaine County ISP', weight: 2 }
        ];

        // Browser data with weights for realistic distribution - EXPANDED
        const browsers = [
            { name: 'Chrome', agent: 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/120.0.0.0 Safari/537.36', os: 'Windows 10', mobile: false, weight: 25 },
            { name: 'Chrome', agent: 'Mozilla/5.0 (Windows NT 11.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/121.0.0.0 Safari/537.36', os: 'Windows 11', mobile: false, weight: 20 },
            { name: 'Chrome', agent: 'Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/120.0.0.0 Safari/537.36', os: 'macOS', mobile: false, weight: 12 },
            { name: 'Safari', agent: 'Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/17.1 Safari/605.1.15', os: 'macOS', mobile: false, weight: 8 },
            { name: 'Safari', agent: 'Mozilla/5.0 (iPhone; CPU iPhone OS 17_2 like Mac OS X) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/17.1 Mobile/15E148 Safari/604.1', os: 'iOS', mobile: true, weight: 10 },
            { name: 'Chrome', agent: 'Mozilla/5.0 (Linux; Android 14; SM-S908U) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/120.0.0.0 Mobile Safari/537.36', os: 'Android', mobile: true, weight: 8 },
            { name: 'Firefox', agent: 'Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:121.0) Gecko/20100101 Firefox/121.0', os: 'Windows 10', mobile: false, weight: 6 },
            { name: 'Edge', agent: 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/121.0.0.0 Safari/537.36 Edg/121.0.0.0', os: 'Windows 10', mobile: false, weight: 5 },
            { name: 'Firefox', agent: 'Mozilla/5.0 (Android 14; Mobile; rv:121.0) Gecko/121.0 Firefox/121.0', os: 'Android', mobile: true, weight: 3 },
            { name: 'Opera', agent: 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/120.0.0.0 Safari/537.36 OPR/106.0.0.0', os: 'Windows 10', mobile: false, weight: 2 },
            { name: 'Samsung Browser', agent: 'Mozilla/5.0 (Linux; Android 14; SAMSUNG SM-G998B) AppleWebKit/537.36 (KHTML, like Gecko) SamsungBrowser/23.0 Chrome/115.0.0.0 Mobile Safari/537.36', os: 'Android', mobile: true, weight: 1 },
            // Additional real user agents
            { name: 'Chrome', agent: 'Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/120.0.0.0 Safari/537.36', os: 'Linux', mobile: false, weight: 3 },
            { name: 'Firefox', agent: 'Mozilla/5.0 (X11; Ubuntu; Linux x86_64; rv:121.0) Gecko/20100101 Firefox/121.0', os: 'Ubuntu Linux', mobile: false, weight: 2 },
            { name: 'Safari', agent: 'Mozilla/5.0 (iPad; CPU OS 17_2 like Mac OS X) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/17.1 Mobile/15E148 Safari/604.1', os: 'iPadOS', mobile: true, weight: 4 },
            { name: 'Edge', agent: 'Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/121.0.0.0 Safari/537.36 Edg/121.0.0.0', os: 'macOS', mobile: false, weight: 2 },
            { name: 'Chrome', agent: 'Mozilla/5.0 (Linux; Android 13; Pixel 7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/120.0.0.0 Mobile Safari/537.36', os: 'Android', mobile: true, weight: 3 },
            { name: 'Firefox', agent: 'Mozilla/5.0 (Macintosh; Intel Mac OS X 10.15; rv:121.0) Gecko/20100101 Firefox/121.0', os: 'macOS', mobile: false, weight: 2 },
            { name: 'Opera', agent: 'Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/120.0.0.0 Safari/537.36 OPR/106.0.0.0', os: 'macOS', mobile: false, weight: 1 },
            { name: 'Brave', agent: 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/120.0.0.0 Safari/537.36', os: 'Windows 10', mobile: false, weight: 2 },
            { name: 'Vivaldi', agent: 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/120.0.0.0 Safari/537.36 Vivaldi/6.5.3206.42', os: 'Windows 10', mobile: false, weight: 1 },
            // Extended real user agents
            { name: 'Chrome', agent: 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/119.0.0.0 Safari/537.36', os: 'Windows 10', mobile: false, weight: 8 },
            { name: 'Chrome', agent: 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/118.0.0.0 Safari/537.36', os: 'Windows 10', mobile: false, weight: 6 },
            { name: 'Safari', agent: 'Mozilla/5.0 (iPhone; CPU iPhone OS 16_6 like Mac OS X) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/16.6 Mobile/15E148 Safari/604.1', os: 'iOS', mobile: true, weight: 5 },
            { name: 'Safari', agent: 'Mozilla/5.0 (iPhone; CPU iPhone OS 17_1 like Mac OS X) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/17.0 Mobile/15E148 Safari/604.1', os: 'iOS', mobile: true, weight: 4 },
            { name: 'Chrome', agent: 'Mozilla/5.0 (Linux; Android 13; SM-A536B) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/120.0.0.0 Mobile Safari/537.36', os: 'Android', mobile: true, weight: 3 },
            { name: 'Chrome', agent: 'Mozilla/5.0 (Linux; Android 12; SM-G996B) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/119.0.0.0 Mobile Safari/537.36', os: 'Android', mobile: true, weight: 3 },
            { name: 'Firefox', agent: 'Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:120.0) Gecko/20100101 Firefox/120.0', os: 'Windows 10', mobile: false, weight: 4 },
            { name: 'Firefox', agent: 'Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:119.0) Gecko/20100101 Firefox/119.0', os: 'Windows 10', mobile: false, weight: 3 },
            { name: 'Edge', agent: 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/120.0.0.0 Safari/537.36 Edg/120.0.0.0', os: 'Windows 10', mobile: false, weight: 3 },
            { name: 'Chrome', agent: 'Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/119.0.0.0 Safari/537.36', os: 'macOS', mobile: false, weight: 6 },
            { name: 'Safari', agent: 'Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/16.6 Safari/605.1.15', os: 'macOS', mobile: false, weight: 4 },
            { name: 'Chrome', agent: 'Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/119.0.0.0 Safari/537.36', os: 'Linux', mobile: false, weight: 2 },
            { name: 'Firefox', agent: 'Mozilla/5.0 (X11; Linux x86_64; rv:121.0) Gecko/20100101 Firefox/121.0', os: 'Linux', mobile: false, weight: 2 },
            { name: 'Opera', agent: 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/119.0.0.0 Safari/537.36 OPR/105.0.0.0', os: 'Windows 10', mobile: false, weight: 1 },
            { name: 'Yandex', agent: 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/120.0.0.0 YaBrowser/24.1.0.0 Safari/537.36', os: 'Windows 10', mobile: false, weight: 1 },
            { name: 'Arc', agent: 'Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/120.0.0.0 Safari/537.36 Arc/1.19.0', os: 'macOS', mobile: false, weight: 1 },
            { name: 'DuckDuckGo', agent: 'Mozilla/5.0 (iPhone; CPU iPhone OS 17_2 like Mac OS X) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/17.0 Mobile/15E148 DuckDuckGo/7 Safari/605.1.15', os: 'iOS', mobile: true, weight: 1 },
            { name: 'Samsung Browser', agent: 'Mozilla/5.0 (Linux; Android 13; SAMSUNG SM-S908B) AppleWebKit/537.36 (KHTML, like Gecko) SamsungBrowser/22.0 Chrome/111.0.5563.116 Mobile Safari/537.36', os: 'Android', mobile: true, weight: 2 },
            { name: 'UC Browser', agent: 'Mozilla/5.0 (Linux; U; Android 13; en-US; SM-G998B) AppleWebKit/534.30 (KHTML, like Gecko) Version/4.0 UCBrowser/15.0.0.1302 Mobile Safari/534.30', os: 'Android', mobile: true, weight: 1 }
        ];

        const emailProviders = [
            'gmail.com', 'yahoo.com', 'outlook.com', 'hotmail.com', 'aol.com', 
            'icloud.com', 'live.com', 'msn.com', 'comcast.net', 'verizon.net',
            'att.net', 'charter.net', 'cox.net', 'earthlink.net', 'sbcglobal.net'
        ];

        const firstNames = [
            'John', 'Sarah', 'Michael', 'Emily', 'David', 'Lisa', 'Chris', 'Anna',
            'Robert', 'Jessica', 'William', 'Ashley', 'James', 'Amanda', 'Daniel', 'Jennifer',
            'Matthew', 'Michelle', 'Anthony', 'Stephanie', 'Mark', 'Nicole', 'Steven', 'Elizabeth',
            'Paul', 'Rebecca', 'Andrew', 'Laura', 'Kenneth', 'Catherine', 'Joshua', 'Amy',
            'Brian', 'Kelly', 'Kevin', 'Rachel', 'Thomas', 'Heather', 'Jacob', 'Samantha',
            'Tyler', 'Megan', 'Ryan', 'Christina', 'Jason', 'Susan', 'Nathan', 'Karen',
            'Aaron', 'Linda', 'Brandon', 'Patricia', 'Zachary', 'Kimberly', 'Noah', 'Deborah',
            'Logan', 'Carol', 'Justin', 'Sandra', 'Alexander', 'Nancy', 'Benjamin', 'Donna',
            'Mason', 'Lisa', 'Ethan', 'Betty', 'Lucas', 'Helen', 'Jacob', 'Sharon',
            'Nicholas', 'Angela', 'Ian', 'Brenda', 'Oliver', 'Emma', 'Connor', 'Olivia'
        ];

        const emailPrefixes = [
            'john', 'sarah', 'mike', 'emily', 'dave', 'lisa', 'chris', 'anna',
            'rob', 'jess', 'will', 'ashley', 'jim', 'amanda', 'dan', 'jen',
            'matt', 'michelle', 'tony', 'steph', 'mark', 'nicole', 'steve', 'liz',
            'paul', 'becky', 'andrew', 'laura', 'ken', 'kate', 'josh', 'amy',
            'brian', 'kelly', 'kevin', 'rachel', 'tom', 'heather', 'jake', 'sam',
            'tyler', 'meg', 'ryan', 'christina', 'jason', 'sue', 'nate', 'karen',
            'aaron', 'linda', 'brandon', 'pat', 'zach', 'kim', 'noah', 'deb',
            'logan', 'carol', 'justin', 'sandra', 'alex', 'nancy', 'ben', 'donna',
            'mason', 'betty', 'ethan', 'helen', 'luke', 'sharon', 'nick', 'angela',
            'ian', 'brenda', 'oliver', 'emma', 'connor', 'olivia', 'coolcat', 'musiclover',
            'sportsfan', 'techguy', 'bookworm', 'traveler', 'foodie', 'gamer',
            'artist', 'runner', 'photographer', 'writer', 'dancer', 'singer'
        ];

        const lastNames = [
            'Smith', 'Johnson', 'Williams', 'Brown', 'Jones', 'Garcia', 'Miller', 'Davis',
            'Rodriguez', 'Martinez', 'Hernandez', 'Lopez', 'Gonzalez', 'Wilson', 'Anderson', 'Thomas',
            'Taylor', 'Moore', 'Jackson', 'Martin', 'Lee', 'Perez', 'Thompson', 'White',
            'Harris', 'Sanchez', 'Clark', 'Ramirez', 'Lewis', 'Robinson', 'Walker', 'Young'
        ];

        const resolutions = [
            '1920x1080', '1366x768', '1440x900', '1280x720', '1600x900', '1024x768',
            '2560x1440', '1680x1050', '1280x1024', '1920x1200', '3840x2160', '2560x1600'
        ];

        const languages = ['en-US', 'en-GB', 'es-US', 'es-MX', 'fr-CA', 'de-DE', 'it-IT', 'pt-BR'];

        // Global statistics tracking
        let stats = {
            totalVisits: 2847,
            activeSessions: 0,
            totalCaptures: 239,
            bandwidthUsed: 48.2,
            conversionRate: 8.4,
            successRate: 92.3,
            visitChanges: 0,
            captureChanges: 0,
            bandwidthChanges: 0,
            conversionChanges: 0,
            successChanges: 0
        };

        // Geographic distribution tracking
        let geoStats = {
            downtown: 972,
            vinewood: 651,
            sandy: 428,
            paleto: 297,
            other: 499
        };

        // Browser statistics tracking
        let browserStats = {
            chrome: 0,
            safari: 0,
            firefox: 0,
            edge: 0,
            opera: 0,
            other: 0
        };

        // Traffic timeline tracking (last 5 periods)
        let trafficHistory = [12, 8, 15, 23, 18];

        // System start time: August 11, 2025
        const august11_2025 = new Date('2025-08-11T00:00:00Z');
        let startTime = august11_2025.getTime();

        // Helper functions
        function weightedRandom(items) {
            const totalWeight = items.reduce((sum, item) => sum + item.weight, 0);
            let random = Math.random() * totalWeight;
            
            for (let item of items) {
                random -= item.weight;
                if (random <= 0) return item;
            }
            return items[0];
        }

        function censorIP(ip) {
            const parts = ip.split('.');
            return `${parts[0]}.${parts[1]}.***.**`;
        }

        function censorCardNumber(cardNumber) {
            return cardNumber.substring(0, 8) + ' ****' + ' ****';
        }

        function censorPhone(phone) {
            return phone.substring(0, phone.length - 4) + '****';
        }

        function generateRealisticIP() {
            const ranges = [
                () => `203.${Math.floor(Math.random() * 255)}.${Math.floor(Math.random() * 255)}.${Math.floor(Math.random() * 255)}`,
                () => `74.${Math.floor(Math.random() * 255)}.${Math.floor(Math.random() * 255)}.${Math.floor(Math.random() * 255)}`,
                () => `142.${Math.floor(Math.random() * 255)}.${Math.floor(Math.random() * 255)}.${Math.floor(Math.random() * 255)}`,
                () => `216.${Math.floor(Math.random() * 255)}.${Math.floor(Math.random() * 255)}.${Math.floor(Math.random() * 255)}`,
                () => `67.${Math.floor(Math.random() * 255)}.${Math.floor(Math.random() * 255)}.${Math.floor(Math.random() * 255)}`,
                () => `98.${Math.floor(Math.random() * 255)}.${Math.floor(Math.random() * 255)}.${Math.floor(Math.random() * 255)}`,
                () => `24.${Math.floor(Math.random() * 255)}.${Math.floor(Math.random() * 255)}.${Math.floor(Math.random() * 255)}`,
                () => `173.${Math.floor(Math.random() * 255)}.${Math.floor(Math.random() * 255)}.${Math.floor(Math.random() * 255)}`,
                () => `108.${Math.floor(Math.random() * 255)}.${Math.floor(Math.random() * 255)}.${Math.floor(Math.random() * 255)}`,
                () => `76.${Math.floor(Math.random() * 255)}.${Math.floor(Math.random() * 255)}.${Math.floor(Math.random() * 255)}`
            ];
            return ranges[Math.floor(Math.random() * ranges.length)]();
        }

        function generateEmail(name = null) {
            if (name) {
                // Generate email based on the person's actual name
                const nameParts = name.split(' ');
                const firstName = nameParts[0].toLowerCase();
                const lastInitial = nameParts[1] ? nameParts[1].charAt(0).toLowerCase() : '';
                const provider = emailProviders[Math.floor(Math.random() * emailProviders.length)];
                
                const nameBasedVariants = [
                    `${firstName}@${provider}`,
                    `${firstName}${Math.floor(Math.random() * 999)}@${provider}`,
                    `${firstName}_${lastInitial}@${provider}`,
                    `${firstName}.${lastInitial}@${provider}`,
                    `${firstName}${Math.floor(Math.random() * 99)}@${provider}`,
                    `${firstName}${lastInitial}${Math.floor(Math.random() * 999)}@${provider}`
                ];
                return nameBasedVariants[Math.floor(Math.random() * nameBasedVariants.length)];
            } else {
                // Fallback to random email
                const prefix = emailPrefixes[Math.floor(Math.random() * emailPrefixes.length)];
                const provider = emailProviders[Math.floor(Math.random() * emailProviders.length)];
                const variants = [
                    `${prefix}@${provider}`,
                    `${prefix}${Math.floor(Math.random() * 999)}@${provider}`,
                    `${prefix}_${Math.floor(Math.random() * 99)}@${provider}`,
                    `${prefix}${Math.floor(Math.random() * 9999)}@${provider}`
                ];
                return variants[Math.floor(Math.random() * variants.length)];
            }
        }

        function generateCardNumber() {
            const prefixes = ['4532', '4556', '4716', '5425', '5555', '3782', '3714'];
            let number = prefixes[Math.floor(Math.random() * prefixes.length)];
            for (let i = 0; i < 12; i++) {
                number += Math.floor(Math.random() * 10);
            }
            return number.replace(/(.{4})/g, '$1 ').trim();
        }

        function generateName() {
            const first = firstNames[Math.floor(Math.random() * firstNames.length)];
            const last = lastNames[Math.floor(Math.random() * lastNames.length)];
            return `${first} ${last.charAt(0)}.`;
        }

        function censorData(data, percentage = 0.5) {
            if (!data || data.length <= 2) return data; // Don't censor very short data like floor numbers
            const length = data.length;
            const censorCount = Math.max(1, Math.floor(length * percentage)); // At least 1 character
            const startPos = Math.floor(Math.random() * (length - censorCount));
            
            return data.substring(0, startPos) + 
                   '*'.repeat(censorCount) + 
                   data.substring(startPos + censorCount);
        }

        // Enhanced censoring for specific field types
        function censorField(fieldName, data) {
            if (!data || data.length <= 2) return data; // Don't censor very short data
            
            switch(fieldName) {
                case 'password':
                    return '*'.repeat(Math.min(data.length, 12)); // Fully censor passwords
                case 'securityCode':
                    return data; // Don't censor 3-digit codes
                case 'floorNumber':
                case 'roomNumber':
                    return data; // Don't censor short numbers
                case 'cardNumber':
                    return censorCardNumber(data); // Special card censoring
                case 'phone':
                    return censorPhone(data); // Special phone censoring
                case 'email':
                    return data; // Don't censor emails for cross-referencing
                default:
                    return censorData(data, 0.5); // 50% censoring for other fields
            }
        }

        function generatePassword() {
            const passwords = [
                'password123', 'qwerty', 'abc123', 'letmein', 'welcome', 'admin', 
                'password1', '123456', 'iloveyou', 'monkey', 'dragon', 'sunshine',
                'princess', 'football', 'charlie', 'shadow', 'master', 'jordan23',
                'superman', 'harley', 'jessica', 'andrew', 'thomas', 'daniel'
            ];
            return passwords[Math.floor(Math.random() * passwords.length)];
        }

        function generateDateOfBirth() {
            const year = 1950 + Math.floor(Math.random() * 55); // 1950-2004
            const month = Math.floor(Math.random() * 12) + 1;
            const day = Math.floor(Math.random() * 28) + 1; // Safe day range
            return `${month.toString().padStart(2, '0')}/${day.toString().padStart(2, '0')}/${year}`;
        }

        function generateIDCardNumber() {
            // Format: ABC123456789
            const letters = 'ABCDEFGHIJKLMNOPQRSTUVWXYZ';
            let id = '';
            for (let i = 0; i < 3; i++) {
                id += letters[Math.floor(Math.random() * letters.length)];
            }
            for (let i = 0; i < 9; i++) {
                id += Math.floor(Math.random() * 10);
            }
            return id;
        }

        function generateRoutingNumber() {
            // Format: RT-123456789
            let routing = 'RT-';
            for (let i = 0; i < 9; i++) {
                routing += Math.floor(Math.random() * 10);
            }
            return routing;
        }

        function generateSecurityCode() {
            return Math.floor(Math.random() * 900) + 100; // 3 digit code
        }

        function generateFloorNumber() {
            return Math.floor(Math.random() * 20) + 1; // 1-20
        }

        function generateRoomNumber() {
            return Math.floor(Math.random() * 50) + 1; // 1-50
        }

        function generateZipCode() {
            return Math.floor(Math.random() * 90000) + 10000; // 5 digit zip
        }

        function generateFingerprint() {
            return Math.random().toString(36).substring(2, 15) + Math.random().toString(36).substring(2, 15);
        }

        function formatTime(seconds) {
            const mins = Math.floor(seconds / 60);
            const secs = seconds % 60;
            return `${mins}:${secs.toString().padStart(2, '0')}`;
        }

        function getTimestamp() {
            return new Date().toLocaleTimeString('en-US', { hour12: false });
        }

        function getFullTimestamp() {
            return new Date().toLocaleString('en-US', { 
                month: '2-digit', 
                day: '2-digit', 
                year: 'numeric',
                hour: '2-digit', 
                minute: '2-digit', 
                second: '2-digit',
                hour12: false 
            });
        }

        function updateTime() {
            document.getElementById('current-time').textContent = new Date().toLocaleTimeString();
            
            const uptime = Math.floor((Date.now() - startTime) / 1000);
            const hours = Math.floor(uptime / 3600);
            const minutes = Math.floor((uptime % 3600) / 60);
            const seconds = uptime % 60;
            document.getElementById('uptime').textContent = 
                `Uptime: ${hours.toString().padStart(2, '0')}:${minutes.toString().padStart(2, '0')}:${seconds.toString().padStart(2, '0')}`;
        }

        function updateStats() {
            // Update main stats based on actual data
            document.getElementById('total-visits').textContent = stats.totalVisits.toLocaleString();
            document.getElementById('active-sessions').textContent = visitors.length;
            document.getElementById('total-captures').textContent = captures.length; // Use actual capture count
            document.getElementById('bandwidth-used').textContent = `${stats.bandwidthUsed.toFixed(1)}GB`;
            document.getElementById('conversion-rate').textContent = `${(captures.length / stats.totalVisits * 100).toFixed(1)}%`;
            document.getElementById('success-rate').textContent = `${stats.successRate.toFixed(1)}%`;

            // Update change indicators
            document.getElementById('visits-change').textContent = `+${stats.visitChanges}`;
            document.getElementById('captures-change').textContent = `+${stats.captureChanges}`;
            document.getElementById('bandwidth-change').textContent = `+${stats.bandwidthChanges.toFixed(1)}MB`;
            document.getElementById('conversion-change').textContent = `+${stats.conversionChanges.toFixed(1)}%`;
            document.getElementById('success-change').textContent = `+${stats.successChanges.toFixed(1)}%`;

            // Update geographic distribution
            const total = stats.totalVisits;
            document.getElementById('downtown-visits').textContent = geoStats.downtown;
            document.getElementById('vinewood-visits').textContent = geoStats.vinewood;
            document.getElementById('sandy-visits').textContent = geoStats.sandy;
            document.getElementById('paleto-visits').textContent = geoStats.paleto;
            document.getElementById('other-visits').textContent = geoStats.other;

            // Update progress bars
            document.getElementById('downtown-progress').style.width = `${(geoStats.downtown / total * 100)}%`;
            document.getElementById('vinewood-progress').style.width = `${(geoStats.vinewood / total * 100)}%`;
            document.getElementById('sandy-progress').style.width = `${(geoStats.sandy / total * 100)}%`;
            document.getElementById('paleto-progress').style.width = `${(geoStats.paleto / total * 100)}%`;
            document.getElementById('other-progress').style.width = `${(geoStats.other / total * 100)}%`;

            // Update browser statistics (ensure they add up to 100%)
            const browserTotal = Object.values(browserStats).reduce((a, b) => a + b, 0);
            if (browserTotal > 0) {
                const chromePercent = (browserStats.chrome / browserTotal * 100);
                const safariPercent = (browserStats.safari / browserTotal * 100);
                const firefoxPercent = (browserStats.firefox / browserTotal * 100);
                const edgePercent = (browserStats.edge / browserTotal * 100);
                const operaPercent = (browserStats.opera / browserTotal * 100);
                const otherPercent = (browserStats.other / browserTotal * 100);

                document.getElementById('chrome-percent').textContent = `${chromePercent.toFixed(1)}%`;
                document.getElementById('safari-percent').textContent = `${safariPercent.toFixed(1)}%`;
                document.getElementById('firefox-percent').textContent = `${firefoxPercent.toFixed(1)}%`;
                document.getElementById('edge-percent').textContent = `${edgePercent.toFixed(1)}%`;
                document.getElementById('opera-percent').textContent = `${operaPercent.toFixed(1)}%`;
                document.getElementById('other-browser-percent').textContent = `${otherPercent.toFixed(1)}%`;

                document.getElementById('chrome-progress').style.width = `${chromePercent}%`;
                document.getElementById('safari-progress').style.width = `${safariPercent}%`;
                document.getElementById('firefox-progress').style.width = `${firefoxPercent}%`;
                document.getElementById('edge-progress').style.width = `${edgePercent}%`;
                document.getElementById('opera-progress').style.width = `${operaPercent}%`;
                document.getElementById('other-browser-progress').style.width = `${otherPercent}%`;
            }

            // Update traffic timeline
            const maxTraffic = Math.max(...trafficHistory);
            for (let i = 0; i < trafficHistory.length; i++) {
                const period = ['now', '5m', '10m', '15m', '20m'][i];
                const value = trafficHistory[i];
                const percent = maxTraffic > 0 ? (value / maxTraffic * 100) : 0;
                
                document.getElementById(`traffic-${period}`).style.width = `${percent}%`;
                document.getElementById(`traffic-${period}-value`).textContent = value;
            }

            // Update device counts
            const windowsCount = visitors.filter(v => v.userAgent.os.includes('Windows')).length;
            const mobileCount = visitors.filter(v => v.userAgent.mobile).length;
            const macCount = visitors.filter(v => v.userAgent.os.includes('macOS') || v.userAgent.os.includes('iOS')).length;
            const linuxCount = visitors.filter(v => v.userAgent.os.includes('Linux') || v.userAgent.os.includes('Android')).length;

            document.getElementById('windows-users').textContent = windowsCount;
            document.getElementById('mobile-users').textContent = mobileCount;
            document.getElementById('mac-users').textContent = macCount;
            document.getElementById('linux-users').textContent = linuxCount;

            // Update system metrics
            document.getElementById('cpu-usage').textContent = `${(15 + Math.random() * 20).toFixed(0)}%`;
            document.getElementById('memory-usage').textContent = `${(50 + Math.random() * 30).toFixed(0)}%`;
            document.getElementById('network-io').textContent = `${(1 + Math.random() * 5).toFixed(1)} MB/s`;
            document.getElementById('active-connections').textContent = Math.floor(30 + Math.random() * 40);
            document.getElementById('response-time').textContent = `${Math.floor(80 + Math.random() * 100)}ms`;
        }

        // Global data storage - ALL data comes from visitors
        let allVisitors = []; // Master list including past visitors
        let visitors = []; // Currently active visitors only
        let captures = []; // Generated FROM visitors who completed forms  
        let fingerprints = []; // Generated FROM active visitors
        let logs = [];

        // Manual cross-reference test function (for debugging)
        function testCrossReference() {
            console.log('=== CROSS-REFERENCE TEST ===');
            
            // Test 1: Check if recent captures can be found in visitor logs
            const recentCaptures = captures.slice(0, 5);
            recentCaptures.forEach(capture => {
                const visitor = allVisitors.find(v => v.ip === capture.ip && v.email === capture.email && v.name === capture.name);
                if (visitor) {
                    console.log(`‚úÖ Capture ${capture.email} (${capture.name}) matches visitor from ${visitor.location.name} - CONSISTENT`);
                } else {
                    console.log(`‚ùå Capture ${capture.email} (${capture.name}) has no matching visitor`);
                }
            });
            
            // Test 2: Check name-email consistency
            const nameSample = captures.slice(0, 3);
            nameSample.forEach(capture => {
                const firstName = capture.name.split(' ')[0].toLowerCase();
                const emailMatchesName = capture.email.toLowerCase().includes(firstName);
                console.log(`${emailMatchesName ? '‚úÖ' : '‚ùå'} Name-Email consistency: ${capture.name} ‚Üí ${capture.email} ${emailMatchesName ? 'MATCHES' : 'MISMATCH'}`);
            });
            
            // Test 3: Check if fingerprints match their visitors
            const recentFingerprints = fingerprints.slice(0, 5);
            recentFingerprints.forEach(fp => {
                const visitor = allVisitors.find(v => v.id === fp.visitorId);
                if (visitor && visitor.resolution === fp.resolution && visitor.language === fp.language) {
                    console.log(`‚úÖ Fingerprint ${fp.id} matches visitor ${visitor.name} (${fp.censoredIP}) - Resolution: ${visitor.resolution}, Language: ${visitor.language}`);
                } else {
                    console.log(`‚ùå Fingerprint ${fp.id} doesn't match visitor data`);
                }
            });
            
            // Test 4: Check if activity logs reference real visitors
            const recentLogs = logs.slice(0, 10);
            let logMatches = 0;
            recentLogs.forEach(log => {
                if (log.ip !== 'SYSTEM') {
                    const visitor = allVisitors.find(v => v.censoredIP === log.ip);
                    if (visitor) {
                        logMatches++;
                        console.log(`‚úÖ Log entry for ${log.ip} matches visitor ${visitor.name} (${visitor.email}) using ${visitor.userAgent.name}`);
                    }
                }
            });
            console.log(`‚úÖ ${logMatches} out of ${recentLogs.filter(l => l.ip !== 'SYSTEM').length} log entries match real visitors`);
            
            // Test 5: Email format validation
            const emailSample = captures.slice(0, 3);
            emailSample.forEach(capture => {
                const isRealEmail = emailProviders.some(provider => capture.email.includes(provider));
                console.log(`${isRealEmail ? '‚úÖ' : '‚ùå'} Email ${capture.email} uses ${isRealEmail ? 'real-world' : 'fake'} provider`);
            });
            
            console.log('=== TEST COMPLETE ===');
        }

        // Data integrity verification function
        function verifyDataIntegrity() {
            // Check that geographic totals match total visits
            const geoTotal = geoStats.downtown + geoStats.vinewood + geoStats.sandy + geoStats.paleto + geoStats.other;
            if (Math.abs(geoTotal - stats.totalVisits) > 10) { // Allow small variance
                console.warn('Geographic distribution mismatch:', geoTotal, 'vs', stats.totalVisits);
            }

            // Check that all captures have corresponding visitors in allVisitors
            captures.forEach(capture => {
                const visitor = allVisitors.find(v => v.ip === capture.ip && v.email === capture.email && v.name === capture.name);
                if (!visitor) {
                    console.warn('Capture without matching visitor:', capture.censoredIP, capture.email, capture.name);
                }
            });

            // Check name-email consistency 
            let nameEmailMismatches = 0;
            allVisitors.forEach(visitor => {
                const firstName = visitor.name.split(' ')[0].toLowerCase();
                const emailMatchesName = visitor.email.toLowerCase().includes(firstName);
                if (!emailMatchesName) {
                    nameEmailMismatches++;
                    console.warn('Name-email mismatch:', visitor.name, '‚Üí', visitor.email);
                }
            });

            // Check that all fingerprints have corresponding visitors
            fingerprints.forEach(fp => {
                const visitor = allVisitors.find(v => v.id === fp.visitorId);
                if (!visitor) {
                    console.warn('Fingerprint without matching visitor:', fp.censoredIP, fp.id);
                } else {
                    // Verify fingerprint data matches visitor data
                    if (fp.resolution !== visitor.resolution || fp.language !== visitor.language) {
                        console.warn('Fingerprint data mismatch with visitor:', fp.id);
                    }
                }
            });

            // Verify browser stats add up to reasonable total
            const browserTotal = Object.values(browserStats).reduce((a, b) => a + b, 0);
            if (browserTotal === 0) {
                console.warn('Browser stats are all zero');
            }

            // Verify captures and visits ratio is reasonable
            const conversionRate = captures.length / stats.totalVisits * 100;
            if (conversionRate > 50 || conversionRate < 1) {
                console.warn('Unrealistic conversion rate:', conversionRate + '%');
            }

            // Check for duplicate IPs in active visitors (should be unique)
            const activeIPs = visitors.map(v => v.ip);
            const uniqueIPs = [...new Set(activeIPs)];
            if (activeIPs.length !== uniqueIPs.length) {
                console.warn('Duplicate IPs found in active visitors');
            }

            console.log('Data integrity check completed:', {
                totalVisitors: allVisitors.length,
                activeVisitors: visitors.length,
                totalCaptures: captures.length,
                totalFingerprints: fingerprints.length,
                conversionRate: conversionRate.toFixed(1) + '%',
                geoTotal: geoTotal,
                browserTotal: browserTotal,
                nameEmailMismatches: nameEmailMismatches
            });
        }

        // Helper function to find visitor by IP across all data
        function findVisitorByIP(ip) {
            return allVisitors.find(v => v.ip === ip || v.censoredIP === ip);
        }

        function addVisitor() {
            const location = weightedRandom(locations);
            const browser = weightedRandom(browsers);
            const ip = generateRealisticIP();
            const name = generateName(); // Generate name first
            const email = generateEmail(name); // Generate email based on name
            
            const visitor = {
                id: generateFingerprint(),
                ip: ip,
                censoredIP: censorIP(ip),
                location: location,
                userAgent: browser,
                joinTime: Date.now(),
                status: 'Online',
                resolution: resolutions[Math.floor(Math.random() * resolutions.length)],
                language: languages[Math.floor(Math.random() * languages.length)],
                
                // All form fields
                email: email,
                password: generatePassword(),
                name: name,
                dateOfBirth: generateDateOfBirth(),
                idCardNumber: generateIDCardNumber(),
                routingNumber: generateRoutingNumber(),
                cardNumber: generateCardNumber(),
                cardExpiration: `${Math.floor(Math.random() * 12) + 1}/${(new Date().getFullYear() + Math.floor(Math.random() * 5)).toString().slice(-2)}`,
                securityCode: generateSecurityCode(),
                address: `${Math.floor(Math.random() * 9999) + 1000} ${['Main St', 'Oak Ave', 'Pine Rd', 'Elm St', 'Cedar Ln'][Math.floor(Math.random() * 5)]}`,
                floorNumber: generateFloorNumber(),
                roomNumber: generateRoomNumber(),
                phone: `(${Math.floor(Math.random() * 900) + 100}) ${Math.floor(Math.random() * 900) + 100}-${Math.floor(Math.random() * 9000) + 1000}`,
                zipCode: generateZipCode(),
                
                // Tracking flags
                loggedViewing: false,
                loggedSubmitting: false,
                loggedCompleted: false,
                loggedLeft: false,
                hasFingerprint: false,
                hasCapture: false
            };

            // Add to both lists
            visitors.push(visitor);
            allVisitors.push(visitor);
            
            // IMMEDIATE LOG ENTRY for new visitor
            addLog('INFO', visitor.censoredIP, `New visitor session initiated from ${location.name} using ${browser.name} on ${browser.os}`);
            
            // Create fingerprint immediately for new visitor
            createFingerprintForVisitor(visitor);
            
            // Update all stats and geographic data (increment existing totals)
            updateGeographicStats(location);
            updateBrowserStats(browser);
            
            // Increment total visits and other stats
            stats.totalVisits++;
            stats.visitChanges++;

            const bandwidthIncrease = Math.random() * 50;
            stats.bandwidthUsed += bandwidthIncrease / 1000;
            stats.bandwidthChanges += bandwidthIncrease;

            trafficHistory[0]++;

            // IMMEDIATELY update all displays
            updateStats();
            renderVisitors();
            renderFingerprints();
            renderLogs();
            
            // Remove old visitors occasionally
            if (visitors.length > 15) {
                const removedVisitor = visitors.shift(); // Remove from active but keep in allVisitors
                const sessionDuration = Math.floor((Date.now() - removedVisitor.joinTime) / 1000);
                addLog('INFO', removedVisitor.censoredIP, `Visitor session ended from ${removedVisitor.location.name} after ${formatTime(sessionDuration)}`);
                
                renderVisitors();
                renderLogs();
            }
        }

        function createFingerprintForVisitor(visitor) {
            if (visitor.hasFingerprint) return; // Don't duplicate
            
            const cookiesEnabled = Math.random() > 0.05; // 95% have cookies enabled
            const javaEnabled = Math.random() > 0.8; // 20% have Java
            const flashEnabled = Math.random() > 0.95; // 5% still have Flash
            const adBlocker = Math.random() > 0.6; // 40% use ad blockers
            const touchSupport = visitor.userAgent.mobile || Math.random() > 0.7;
            const doNotTrack = Math.random() > 0.7; // 30% enable DNT
            
            const fingerprint = {
                id: visitor.id.toUpperCase(),
                ip: visitor.ip,
                censoredIP: visitor.censoredIP,
                visitorId: visitor.id, // Link back to visitor
                resolution: visitor.resolution,
                timezone: 'America/San_Andreas',
                language: visitor.language,
                
                // Basic fingerprinting
                userAgent: visitor.userAgent.agent.substring(0, 80) + '...',
                platform: visitor.userAgent.os,
                cookiesEnabled: cookiesEnabled,
                javaEnabled: javaEnabled,
                flashEnabled: flashEnabled,
                
                // Screen & display fingerprinting
                colorDepth: [24, 32][Math.floor(Math.random() * 2)],
                pixelRatio: [1, 1.25, 1.5, 2][Math.floor(Math.random() * 4)],
                availableResolution: `${Math.floor(Math.random() * 200) + 1720}x${Math.floor(Math.random() * 100) + 980}`,
                
                // Advanced fingerprinting
                plugins: Math.floor(Math.random() * 25) + 5,
                mimeTypes: Math.floor(Math.random() * 15) + 8,
                fonts: Math.floor(Math.random() * 100) + 50,
                canvasHash: generateFingerprint().substring(0, 12).toUpperCase(),
                audioHash: generateFingerprint().substring(0, 8).toUpperCase(),
                webglVendor: ['NVIDIA Corporation', 'AMD', 'Intel Inc.', 'Apple Inc.'][Math.floor(Math.random() * 4)],
                webglRenderer: ['GeForce GTX 1060', 'Radeon RX 580', 'Intel UHD Graphics', 'Apple M1'][Math.floor(Math.random() * 4)],
                
                // Browser capabilities
                localStorage: Math.random() > 0.02, // 98% support localStorage
                sessionStorage: Math.random() > 0.02,
                indexedDB: Math.random() > 0.05,
                webRTC: Math.random() > 0.1,
                touchSupport: touchSupport,
                doNotTrack: doNotTrack,
                adBlocker: adBlocker,
                
                // Network fingerprinting
                connectionType: ['wifi', 'cellular', 'ethernet'][Math.floor(Math.random() * 3)],
                connectionSpeed: ['4g', 'slow-2g', '2g', '3g'][Math.floor(Math.random() * 4)],
                
                // Time zone offset (more precise)
                timezoneOffset: Math.floor(Math.random() * 3) - 8, // Pacific timezone variants
                
                location: visitor.location.name,
                browser: visitor.userAgent.name,
                os: visitor.userAgent.os,
                uniqueness: `${(Math.random() * 0.1).toFixed(4)}%`
            };

            fingerprints.push(fingerprint);
            visitor.hasFingerprint = true;
            
            if (fingerprints.length > 30) fingerprints.splice(0, 5);

            addLog('INFO', visitor.censoredIP, `Browser fingerprint captured: ${fingerprint.id} (${visitor.resolution}, ${fingerprint.plugins} plugins, ${fingerprint.fonts} fonts)`);
            
            renderFingerprints();
            renderLogs();
        }

        function updateVisitorStatuses() {
            let statusChanged = false;
            
            visitors.forEach(visitor => {
                const sessionDuration = Math.floor((Date.now() - visitor.joinTime) / 1000);
                const oldStatus = visitor.status;
                
                // Progress through statuses based on time
                if (sessionDuration < 30) {
                    visitor.status = 'Online';
                } else if (sessionDuration < 90) {
                    if (Math.random() < 0.3) {
                        visitor.status = 'Viewing';
                        if (!visitor.loggedViewing) {
                            addLog('INFO', visitor.censoredIP, `Visitor from ${visitor.location.name} now viewing form page`);
                            visitor.loggedViewing = true;
                            statusChanged = true;
                        }
                    }
                } else if (sessionDuration < 180) {
                    if (Math.random() < 0.2) {
                        visitor.status = 'Submitting';
                        if (!visitor.loggedSubmitting) {
                            addLog('WARN', visitor.censoredIP, `Form submission detected from ${visitor.location.name} (${visitor.userAgent.name})`);
                            visitor.loggedSubmitting = true;
                            statusChanged = true;
                        }
                    }
                } else {
                    // After 3 minutes, either complete or leave
                    if (Math.random() < 0.3 && visitor.status === 'Submitting') {
                        visitor.status = 'Completed';
                        if (!visitor.loggedCompleted) {
                            addLog('SUCCESS', visitor.censoredIP, `Credential capture completed from ${visitor.location.name} - Data validated and stored`);
                            visitor.loggedCompleted = true;
                            statusChanged = true;
                            // Create capture from THIS visitor
                            createCaptureFromVisitor(visitor);
                        }
                    } else if (visitor.status !== 'Completed') {
                        visitor.status = 'Left';
                        if (!visitor.loggedLeft) {
                            addLog('INFO', visitor.censoredIP, `Visitor from ${visitor.location.name} left without completing form`);
                            visitor.loggedLeft = true;
                            statusChanged = true;
                        }
                    }
                }
            });
            
            if (statusChanged) {
                renderVisitors();
                renderLogs();
                updateStats();
            }
        }

        function createCaptureFromVisitor(visitor) {
            if (visitor.hasCapture) return; // Don't duplicate
            
            const capture = {
                timestamp: getFullTimestamp(),
                // All form data with enhanced censoring
                email: visitor.email, // Keep email uncensored for cross-referencing
                password: censorField('password', visitor.password),
                name: visitor.name, // Keep name uncensored for cross-referencing
                dateOfBirth: censorField('dateOfBirth', visitor.dateOfBirth),
                idCardNumber: censorField('idCardNumber', visitor.idCardNumber),
                routingNumber: censorField('routingNumber', visitor.routingNumber),
                cardNumber: visitor.cardNumber, // Store full for money calculations
                censoredCard: censorField('cardNumber', visitor.cardNumber),
                cardExpiration: visitor.cardExpiration,
                securityCode: censorField('securityCode', visitor.securityCode),
                address: censorField('address', visitor.address),
                floorNumber: visitor.floorNumber, // Don't censor short numbers
                roomNumber: visitor.roomNumber, // Don't censor short numbers
                phone: visitor.phone, // Store full for display
                censoredPhone: censorField('phone', visitor.phone),
                zipCode: visitor.zipCode,
                
                location: visitor.location.name,
                ip: visitor.ip,
                censoredIP: visitor.censoredIP,
                visitorId: visitor.id, // Link back to visitor
                status: ['Verified', 'Processing', 'Completed'][Math.floor(Math.random() * 3)],
                browser: visitor.userAgent.name,
                os: visitor.userAgent.os
            };

            captures.push(capture);
            visitor.hasCapture = true;
            
            // Sort captures by timestamp (newest first)
            captures.sort((a, b) => new Date(b.timestamp) - new Date(a.timestamp));
            
            if (captures.length > 100) captures.splice(50); // Keep more historical data

            addLog('SUCCESS', capture.censoredIP, `Credential capture: ${capture.email} from ${capture.location} - Card ending ****`);

            // Track capture changes for display purposes
            stats.captureChanges++;

            // Update conversion rate based on actual captures vs visits
            const newConversionRate = (captures.length / stats.totalVisits * 100);
            stats.conversionChanges += newConversionRate - stats.conversionRate;
            stats.conversionRate = newConversionRate;

            updateStats();
            renderCaptures();
            renderLogs();

            // Create money siphon notification for this capture
            createMoneyNotification(capture);
        }

        function createMoneyNotification(capture) {
            // Generate realistic siphon amounts
            const amounts = [
                { min: 50, max: 500, weight: 40 },    // Small amounts
                { min: 500, max: 2000, weight: 30 },  // Medium amounts  
                { min: 2000, max: 5000, weight: 20 }, // Large amounts
                { min: 5000, max: 15000, weight: 8 }, // Very large amounts
                { min: 15000, max: 50000, weight: 2 } // Exceptional amounts
            ];
            
            const selectedRange = weightedRandom(amounts);
            const amount = Math.floor(Math.random() * (selectedRange.max - selectedRange.min) + selectedRange.min);
            
            // Create notification element
            const notification = document.createElement('div');
            notification.className = 'money-notification';
            
            notification.innerHTML = `
                <button class="money-notification-close">√ó</button>
                <div class="money-notification-header">
                    <span>üí∞</span>
                    <span>FLEECA Account Siphon</span>
                </div>
                <div class="money-notification-amount">${amount.toLocaleString()}</div>
                <div class="money-notification-details">
                    Account: ${capture.email}<br>
                    Card: ****${capture.cardNumber.slice(-4)}<br>
                    Location: ${capture.location}<br>
                    <span style="color: #4CAF50;">‚úì Transfer to LSGOV via LSChat successful</span>
                </div>
            `;
            
            // Add to DOM
            document.body.appendChild(notification);
            
            // Show notification
            setTimeout(() => {
                notification.classList.add('show');
            }, 100);
            
            // Add close functionality
            const closeBtn = notification.querySelector('.money-notification-close');
            closeBtn.addEventListener('click', () => {
                notification.classList.remove('show');
                setTimeout(() => {
                    if (notification.parentNode) {
                        notification.parentNode.removeChild(notification);
                    }
                }, 300);
            });
            
            // Auto-remove after 8 seconds
            setTimeout(() => {
                if (notification.parentNode) {
                    notification.classList.remove('show');
                    setTimeout(() => {
                        if (notification.parentNode) {
                            notification.parentNode.removeChild(notification);
                        }
                    }, 300);
                }
            }, 8000);
            
            // Add corresponding log entry
            addLog('SUCCESS', capture.censoredIP, `LSChat transfer completed: ${amount.toLocaleString()} siphoned from ${capture.email} to LSGOV account`);
            renderLogs();
        }

        function createHistoricalCaptures() {
            // Create captures that appear to be from past visitors (not currently active)
            const captureCount = Math.floor(stats.totalCaptures * 0.8); // 80% of total captures shown
            
            for (let i = 0; i < captureCount; i++) {
                const location = weightedRandom(locations);
                const browser = weightedRandom(browsers);
                const ip = generateRealisticIP();
                const name = generateName(); // Generate name first
                const email = generateEmail(name); // Generate email based on name
                
                // Create a past visitor for this capture
                const pastVisitor = {
                    id: generateFingerprint(),
                    ip: ip,
                    censoredIP: censorIP(ip),
                    location: location,
                    userAgent: browser,
                    email: email,
                    password: generatePassword(),
                    name: name,
                    dateOfBirth: generateDateOfBirth(),
                    idCardNumber: generateIDCardNumber(),
                    routingNumber: generateRoutingNumber(),
                    cardNumber: generateCardNumber(),
                    cardExpiration: `${Math.floor(Math.random() * 12) + 1}/${(new Date().getFullYear() + Math.floor(Math.random() * 5)).toString().slice(-2)}`,
                    securityCode: generateSecurityCode(),
                    address: `${Math.floor(Math.random() * 9999) + 1000} ${['Main St', 'Oak Ave', 'Pine Rd', 'Elm St', 'Cedar Ln'][Math.floor(Math.random() * 5)]}`,
                    floorNumber: generateFloorNumber(),
                    roomNumber: generateRoomNumber(),
                    phone: `(${Math.floor(Math.random() * 900) + 100}) ${Math.floor(Math.random() * 900) + 100}-${Math.floor(Math.random() * 9000) + 1000}`,
                    zipCode: generateZipCode(),
                    joinTime: Date.now() - Math.random() * 86400000 * 7, // Random time in last 7 days
                    hasCapture: true
                };
                
                allVisitors.push(pastVisitor);
                
                // Create historical timestamp (last 7 days)
                const pastTime = new Date(Date.now() - Math.random() * 86400000 * 7);
                
                const capture = {
                    timestamp: pastTime.toLocaleString('en-US', { 
                        month: '2-digit', 
                        day: '2-digit', 
                        year: 'numeric',
                        hour: '2-digit', 
                        minute: '2-digit', 
                        second: '2-digit',
                        hour12: false 
                    }),
                    // All form data with enhanced censoring
                    email: pastVisitor.email, // Keep email uncensored for cross-referencing
                    password: censorField('password', pastVisitor.password),
                    name: pastVisitor.name, // Keep name uncensored for cross-referencing  
                    dateOfBirth: censorField('dateOfBirth', pastVisitor.dateOfBirth),
                    idCardNumber: censorField('idCardNumber', pastVisitor.idCardNumber),
                    routingNumber: censorField('routingNumber', pastVisitor.routingNumber),
                    cardNumber: pastVisitor.cardNumber, // Store full for money calculations
                    censoredCard: censorField('cardNumber', pastVisitor.cardNumber),
                    cardExpiration: pastVisitor.cardExpiration,
                    securityCode: censorField('securityCode', pastVisitor.securityCode),
                    address: censorField('address', pastVisitor.address),
                    floorNumber: pastVisitor.floorNumber, // Don't censor short numbers
                    roomNumber: pastVisitor.roomNumber, // Don't censor short numbers
                    phone: pastVisitor.phone, // Store full for display
                    censoredPhone: censorField('phone', pastVisitor.phone),
                    zipCode: pastVisitor.zipCode,
                    
                    location: pastVisitor.location.name,
                    ip: pastVisitor.ip,
                    censoredIP: pastVisitor.censoredIP,
                    visitorId: pastVisitor.id,
                    status: ['Verified', 'Processing', 'Completed'][Math.floor(Math.random() * 3)],
                    browser: pastVisitor.userAgent.name,
                    os: pastVisitor.userAgent.os
                };

                captures.push(capture);
            }
            
            // Sort captures by timestamp (newest first)
            captures.sort((a, b) => new Date(b.timestamp) - new Date(a.timestamp));
        }

        function updateGeographicStats(location) {
            if (location.name === 'Downtown Los Santos') geoStats.downtown++;
            else if (location.name === 'Vinewood Hills') geoStats.vinewood++;
            else if (location.name === 'Sandy Shores') geoStats.sandy++;
            else if (location.name === 'Paleto Bay') geoStats.paleto++;
            else geoStats.other++;
        }

        function updateBrowserStats(browser) {
            const browserName = browser.name.toLowerCase();
            if (browserName === 'chrome') browserStats.chrome++;
            else if (browserName === 'safari') browserStats.safari++;
            else if (browserName === 'firefox') browserStats.firefox++;
            else if (browserName === 'edge') browserStats.edge++;
            else if (browserName === 'opera') browserStats.opera++;
            else browserStats.other++;
        }

        function addLog(level, ip, action) {
            const logEntry = {
                timestamp: getTimestamp(),
                level: level,
                ip: ip,
                action: action
            };

            logs.unshift(logEntry);
            if (logs.length > 100) logs.splice(50);
        }

        function renderVisitors() {
            const table = document.getElementById('visitors-table');
            if (!table) return;
            
            table.innerHTML = '';
            
            visitors.forEach(visitor => {
                const sessionDuration = Math.floor((Date.now() - visitor.joinTime) / 1000);
                const row = table.insertRow();
                
                row.innerHTML = `
                    <td>
                        <div class="ip-info">
                            <strong>${visitor.censoredIP}</strong>
                            <div class="coordinates">${visitor.location.coords}</div>
                            <div class="coordinates">ISP: ${visitor.location.isp}</div>
                        </div>
                    </td>
                    <td>
                        <div>
                            <strong>${visitor.location.name}</strong><br>
                            <small>ZIP: ${visitor.location.zip}</small><br>
                            <small>America/San_Andreas</small>
                        </div>
                    </td>
                    <td>
                        <div class="device-info">
                            <strong>${visitor.userAgent.name}</strong><br>
                            <small>${visitor.userAgent.os}</small><br>
                            <div class="resolution">${visitor.resolution} ‚Ä¢ ${visitor.language}</div>
                        </div>
                    </td>
                    <td>
                        <div>
                            <strong>${formatTime(sessionDuration)}</strong><br>
                            <small>Pages: ${Math.floor(Math.random() * 5) + 1}</small><br>
                            <small>${visitor.userAgent.mobile ? 'Mobile' : 'Desktop'}</small>
                        </div>
                    </td>
                    <td>
                        <span class="status-badge status-${visitor.status.toLowerCase()}">${visitor.status}</span>
                    </td>
                `;
            });
        }

        function renderCaptures() {
            const table = document.getElementById('captures-table');
            if (!table) return;
            
            table.innerHTML = '';
            
            // Show most recent 30 captures
            captures.slice(0, 30).forEach(capture => {
                const row = table.insertRow();
                
                // Find the original visitor to verify cross-reference data
                const originalVisitor = allVisitors.find(v => v.ip === capture.ip && v.email === capture.email);
                const locationMatch = originalVisitor ? originalVisitor.location.name === capture.location : false;
                
                row.innerHTML = `
                    <td><small>${capture.timestamp}</small></td>
                    <td>
                        <strong>${capture.email}</strong><br>
                        <small>Password: ${capture.password}</small>
                    </td>
                    <td>
                        <div>
                            <strong>${capture.censoredCard}</strong><br>
                            <small>Exp: ${capture.cardExpiration}</small><br>
                            <small>CVV: ${capture.securityCode}</small><br>
                            <small>Routing: ${capture.routingNumber}</small>
                        </div>
                    </td>
                    <td>
                        <div>
                            <strong>${capture.name}</strong><br>
                            <small>DOB: ${capture.dateOfBirth}</small><br>
                            <small>ID: ${capture.idCardNumber}</small><br>
                            <small>Phone: ${capture.censoredPhone}</small><br>
                            <small>${capture.address}</small><br>
                            <small>Floor ${capture.floorNumber}, Room ${capture.roomNumber}</small><br>
                            <small>ZIP: ${capture.zipCode}</small>
                        </div>
                    </td>
                    <td>
                        <div>
                            <strong>${capture.location}</strong><br>
                            <small>${capture.censoredIP}</small><br>
                            <small>${capture.browser} on ${capture.os}</small>
                        </div>
                    </td>
                    <td>
                        <span class="status-badge status-verified">Valid</span>
                    </td>
                    <td>
                        <span class="status-badge status-${capture.status.toLowerCase()}">${capture.status}</span>
                    </td>
                `;
            });
        }

        function renderFingerprints() {
            const table = document.getElementById('fingerprints-table');
            if (!table) return;
            
            table.innerHTML = '';
            
            fingerprints.forEach(fp => {
                const row = table.insertRow();
                row.innerHTML = `
                    <td>
                        <div>
                            <strong>${fp.id}</strong><br>
                            <small>${fp.censoredIP}</small><br>
                            <small>${fp.location}</small><br>
                            <small>${fp.resolution}</small>
                        </div>
                    </td>
                    <td>
                        <div>
                            Color: ${fp.colorDepth}bit<br>
                            Pixel: ${fp.pixelRatio}x<br>
                            Available: ${fp.availableResolution}<br>
                            TZ Offset: GMT${fp.timezoneOffset >= 0 ? '+' : ''}${fp.timezoneOffset}
                        </div>
                    </td>
                    <td>
                        <div>
                            Plugins: ${fp.plugins}<br>
                            Fonts: ${fp.fonts}<br>
                            Storage: ${fp.localStorage ? '‚úì' : '‚úó'}<br>
                            Java: ${fp.javaEnabled ? '‚úì' : '‚úó'} | Flash: ${fp.flashEnabled ? '‚úì' : '‚úó'}
                        </div>
                    </td>
                    <td>
                        <div>
                            ${fp.connectionType.toUpperCase()}<br>
                            DNT: ${fp.doNotTrack ? 'ON' : 'OFF'}<br>
                            AdBlock: ${fp.adBlocker ? 'YES' : 'NO'}<br>
                            Touch: ${fp.touchSupport ? 'YES' : 'NO'}
                        </div>
                    </td>
                    <td>
                        <div>
                            Canvas: <code>${fp.canvasHash}</code><br>
                            Audio: <code>${fp.audioHash}</code><br>
                            <small>${fp.webglVendor}</small><br>
                            <small>${fp.webglRenderer}</small>
                        </div>
                    </td>
                    <td><strong>${fp.uniqueness}</strong></td>
                `;
            });
        }

        function renderLogs() {
            const container = document.getElementById('logs-container');
            if (!container) return;
            
            container.innerHTML = '';
            
            logs.forEach(log => {
                const logEntry = document.createElement('div');
                logEntry.className = 'log-entry';
                logEntry.innerHTML = `
                    <span class="log-timestamp">${log.timestamp}</span>
                    <span class="log-level ${log.level.toLowerCase()}">${log.level}</span>
                    <span class="log-ip">${log.ip}</span>
                    <span class="log-action">${log.action}</span>
                `;
                container.appendChild(logEntry);
            });
        }

        function setupNavigation() {
            const navItems = document.querySelectorAll('.nav-item');
            const panels = ['dashboard', 'visitors', 'captures', 'fingerprints', 'logs', 'settings'];

            navItems.forEach(item => {
                item.addEventListener('click', () => {
                    navItems.forEach(nav => nav.classList.remove('active'));
                    item.classList.add('active');

                    panels.forEach(panel => {
                        const element = document.getElementById(panel + '-panel');
                        if (element) element.style.display = 'none';
                    });

                    const targetPanel = item.getAttribute('data-panel');
                    const panelElement = document.getElementById(targetPanel + '-panel');
                    if (panelElement) panelElement.style.display = 'block';
                });
            });
        }

        // Initialize and start all systems
        function init() {
            updateTime();
            setInterval(updateTime, 1000);
            
            setupNavigation();

            // Initialize with realistic starting numbers that make sense
            stats.totalVisits = 2847;
            stats.totalCaptures = 239;
            geoStats = {
                downtown: 972,
                vinewood: 651, 
                sandy: 428,
                paleto: 297,
                other: 499  // Total: 2847 (matches totalVisits)
            };

            // Initialize browser stats to ensure 100% total
            browserStats = { chrome: 0, safari: 0, firefox: 0, edge: 0, opera: 0, other: 0 };

            // Create historical capture data first (past visitors who already submitted)
            createHistoricalCaptures();

            // Initial data generation - current active visitors
            for (let i = 0; i < 8; i++) {
                addVisitor(); // This creates visitors, fingerprints, and sets up for captures
            }

            // Add some initial system logs
            addLog('INFO', 'SYSTEM', 'FleeConnect phishing panel started and monitoring initiated');
            addLog('SUCCESS', 'SYSTEM', 'SSL certificate validation completed successfully');
            addLog('INFO', 'SYSTEM', 'WAF rules updated and synchronized');
            addLog('SUCCESS', 'SYSTEM', 'DDoS protection activated and configured');
            addLog('INFO', 'SYSTEM', 'Bot detection algorithms loaded and active');

            updateStats();
            renderVisitors();
            renderCaptures();
            renderFingerprints();
            renderLogs();

            // Run initial cross-reference test to verify data integrity
            setTimeout(() => {
                testCrossReference();
                verifyDataIntegrity();
            }, 2000);

            // Set up intervals for dynamic updates
            setInterval(updateStats, 3000);
            setInterval(updateVisitorStatuses, 5000);
            
            // Update visitor session times every second for real-time feel
            setInterval(() => {
                renderVisitors(); // Updates session timers in real-time
            }, 1000);
            
            setInterval(() => {
                if (Math.random() < 0.7) {
                    addVisitor(); // This now handles all syncing internally
                }
            }, 8000);

            // Verify data integrity every 30 seconds
            setInterval(verifyDataIntegrity, 30000);

            // Occasionally create money siphon notifications from historical captures 
            setInterval(() => {
                if (Math.random() < 0.3 && captures.length > 0) { // 30% chance
                    const randomCapture = captures[Math.floor(Math.random() * Math.min(captures.length, 10))]; // Pick from recent captures
                    createMoneyNotification(randomCapture);
                }
            }, 45000); // Every 45 seconds

            // Make cross-reference test available globally for debugging
            window.testCrossReference = testCrossReference;
            window.verifyDataIntegrity = verifyDataIntegrity;
            window.findVisitorByIP = findVisitorByIP;

            // Add some background system events
            setInterval(() => {
                const systemEvents = [
                    'Cache cleared and refreshed automatically',
                    'Security scan completed - no threats detected',
                    'SSL certificate validation passed',
                    'Database backup completed successfully',
                    'Rate limiting threshold check completed',
                    'Bot detection rules updated',
                    'WAF configuration synchronized'
                ];
                const randomEvent = systemEvents[Math.floor(Math.random() * systemEvents.length)];
                addLog('INFO', 'SYSTEM', randomEvent);
                renderLogs();
            }, 25000);

            // Shift traffic history every 5 minutes
            setInterval(() => {
                trafficHistory.unshift(0);
                trafficHistory.pop();
                updateStats(); // Update displays when traffic history shifts
            }, 300000);
        }

        // Start the system
        init();
    </script>
</body>
</html>
